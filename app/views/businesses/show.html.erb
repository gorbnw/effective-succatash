<div class="business-overview">
  <h1 class="business-name"> <%= @business['name'] %> </h1>
  <div class="upper-section">
    <div class="business-overview-left">
      <div class="charts">
        <div id="donutchart"></div>
        <div class="show-doodad">
          <%= render partial: 'doodad', locals: {business: @business} %>
        </div>
      </div>
      <!-- <%= render partial: 'businesses/testimonial_summary', locals: {business: @business} %> -->
    </div>
    <div class="business-overview-right">
      <h3>Business Details</h3>
      <div class="business-images">
        <%= image_tag @business["photos"][1], class: "show-image show-size" %>
        <iframe class="map-frame" frameborder="0" style="border:0" src="https://www.google.com/maps/embed/v1/place?key=<%= ENV['GOOG_MAP_KEY'] %>&q=<%= @business['name'] %>,<%= @business['location']['display_address'] %>" ></iframe>
      </div>
      <%= render partial: 'businesses/details', locals: {business: @business} %>
    </div>
  </div>
  <div class="testimonials-show-container">
    <div class="top-testimonials">
      <div class="positive-testimonial">
        <p class="top-testimonial-header">Most Supported Positive Testimonial</p>
        <% if !@positive_testimonial || @positive_testimonial.votes.count == 0 %>
          <p class="no-testimonials">Not enough testimonials have votes yet.</p>
        <% else %>
          <%= render partial: 'businesses/testimonial', locals: {testimonial: @positive_testimonial } %>
        <% end %>
      </div>
      <div class="negative_testimonial">
        <p class="top-testimonial-header">Most Supported Negative Testimonial</p>
        <% if !@negative_testimonial || @negative_testimonial.votes.count == 0 %>
          <p class="no-testimonials">Not enough testimonials have votes yet.</p>
        <% else %>
          <%= render partial: 'businesses/testimonial', locals: {testimonial: @negative_testimonial } %>
        <% end %>
      </div>
    </div>

    <div class="testimonial-form">
      <% if user_signed_in? %>
        <%= render partial: 'testimonials/new', locals: { testimonial: @testimonial, business: @business } %>
      <% else %>
        <p>Do you have an experience to share? Please <a href="/users/sign_in">login</a>!</p>
      <% end %>
    </div>

    <h3>Testimonials</h3>
    <div class="testimonial-list">
      <% if @testimonials.empty? %>
        <p class="no-testimonials">No one has written a testimonial yet.</p>
        <p class="no-testimonials">Be the first to share your experience!</p>
      <% else %>
        <% @testimonials.each do |testimonial| %>
          <%= render partial: 'businesses/testimonial', locals: {testimonial: testimonial } %>
          <% end %>
      <% end %>
    </div>
  </div>
  <p hidden class="yelp_id"><%= @tag_counts %></p>
</div>
